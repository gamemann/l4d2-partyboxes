## Not Finished & Work In Progress!!!

A [SourceMod](https://www.sourcemod.net/) plugin for [Left 4 Dead 2](https://store.steampowered.com/app/550/Left_4_Dead_2/) that turns upgrade boxes such as incendiary and explosive ammo boxes into random/fun boxes.

This is something I'm going to work on as time goes on and don't have any release date. My main goal is to create a modular core that allows the development of separate plugins as "Boxes" that are chosen from randomly.

I've been really wanting to get back into learning game development so I can create open source games in the future, but first I wanted to make a mod/plugin to Left 4 Dead 2 game servers running SourceMod.

## Preview
*To Do...*

## Config & ConVars
A config file should be generated to `cfg/sourcemod/plugin.l4d2pb.cfg`. Additionally, box-specific configs should be located in the same directory.

Here's the output of the `plugin.l4d2pb.cfg` config file for more information on the current core ConVars.

```bash
// This file was auto-generated by SourceMod (v1.11.0.6968)
// ConVars for plugin "l4d2pb-core.smx"


// The maximum amount of bad boxes that can be opened per round. 0 = disables bad boxes. -1 = no limit.
// -
// Default: "-1"
l4d2_max_bad_boxes "-1"

// The chances of a bad box being opened.
// -
// Default: "0.25"
// Minimum: "0.000000"
// Maximum: "1.000000"
l4d2pb_chance_bad "0.25"

// The chances of a good box being opened.
// -
// Default: "0.15"
// Minimum: "0.000000"
// Maximum: "1.000000"
l4d2pb_chance_good "0.15"

// The chances of a mid box being opened.
// -
// Default: "0.50"
// Minimum: "0.000000"
// Maximum: "1.000000"
l4d2pb_chance_mid "0.50"

// The chances of getting no fun boxes when opened.
// -
// Default: "0.10"
// Minimum: "0.000000"
// Maximum: "1.000000"
l4d2pb_chance_none "0.10"

// Enables or disables L4D2 Party Boxes plugin.
// -
// Default: "1"
// Minimum: "0.000000"
// Maximum: "1.000000"
l4d2pb_enabled "1"

// Whether to display stats in chat on round end.
// -
// Default: "1"
// Minimum: "0.000000"
// Maximum: "1.000000"
l4d2pb_end_round_stats "1"

// The maximum amount of good boxes that can be opened per round. 0 = disables good boxes. -1 = no limit.
// -
// Default: "-1"
l4d2pb_max_good_boxes "-1"

// The maximum amount of mid boxes that can be opened per round. 0 = disables mid boxes. -1 = no limit.
// -
// Default: "-1"
l4d2pb_max_mid_boxes "-1"

// The type of max limits. 0 = round-based. 1 = map-based.
// -
// Default: "0"
// Minimum: "0.000000"
// Maximum: "2.000000"
l4d2pb_max_type "0"

// The plugin's verbose level.
// -
// Default: "0"
// Minimum: "0.000000"
// Maximum: "5.000000"
l4d2pb_verbose "0"

// The type of verbose messages. 0 = prints to chat. 1 = prints to server console. 2 = prints to client's console.
// -
// Default: "0"
// Minimum: "0.000000"
// Maximum: "0.000000"
l4d2pb_verbose_type "0"
```

## Core Natives
Here are a list of core natives you may use when developing your own box types. Take a look at [`scripting/l4d2pb-box-test.sp`](./scripting/l4d2pb-box-test.sp) for a basic example.

```c
/**
 * Prints a debug message from the core plugin.
 *
 * @param req      The required verbose level from the core plugin.
 * @param msg      The debug message to send.
 * @param ...      Formatted arguments for msg.
 *
 * @return void
 */
native void DebugMsg(int req, const char[] msg, any...);

/**
 * Registers a box to core and adds it to the box rotation.
 *
 * @param type      The box type (1 = Good, 2 = Mid, 3 = Bad))
 * @param name      A short/code name for the box.
 * @param display   The box display name.      
 *
 * @return 0 on success or 1 on error.
 */
native int RegisterBox(int type, const char[] name, const char[] display);

/**
 * Unloads a box from the core.
 *
 * @param name      A short/code name for the box.
 *
 * @return 0 on success or 1 on error.
 */
native int UnloadBox(const char[] name);
```

## Core Forwards
Here are core (global) forwards you may call while developing your own box types. Take a look at [`scripting/l4d2pb-box-test.sp`](./scripting/l4d2pb-box-test.sp) for a basic example.

```c
/**
 * Called when a box is opened.
 * 
 * @param type      The type of box opened.
 * @param boxName   The box short/code name that was opened.
 * @param userid    The user ID who opened the box.
 * 
 */
public void BoxOpened(int type, const char[] boxName, int userId);
```

## Credits
* [Christian Deacon](https://github.com/gamemann)